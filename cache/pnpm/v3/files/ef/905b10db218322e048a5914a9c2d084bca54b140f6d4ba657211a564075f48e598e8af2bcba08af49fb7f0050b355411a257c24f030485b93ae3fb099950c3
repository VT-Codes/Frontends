const a2_0x2f77=['map','response','fileStorage','cacheError','value','push','then','apply','../../../utilities/environment','startRun','resolve','VERBOSE_LOGGING','extractErrorMessage','.\x20Status\x20404.','retrieve','axiosException','storage','runContext','remote-cache-hit','defineProperty','next','status','Nx\x20Cloud:\x20Cache\x20miss\x20','note','store','filter','storeRequests','reduce','__awaiter','forEach','__esModule','api','hash','waitForStoreRequestsToComplete','requests','put','cache-miss','statuses','CloudRemoteCache','messages','get','all','../../../utilities/nx-imports','done','.\x20Read\x20only\x20token\x20is\x20used.'];(function(_0x4c95a9,_0x2f7748){const _0x2e0914=function(_0x25a846){while(--_0x25a846){_0x4c95a9['push'](_0x4c95a9['shift']());}};_0x2e0914(++_0x2f7748);}(a2_0x2f77,0x1a6));const a2_0x2e09=function(_0x4c95a9,_0x2f7748){_0x4c95a9=_0x4c95a9-0x0;let _0x2e0914=a2_0x2f77[_0x4c95a9];return _0x2e0914;};'use strict';var __awaiter=this&&this[a2_0x2e09('0xb')]||function(_0x5cfeb2,_0x533616,_0x219c92,_0x46c19b){function _0x27d896(_0x30a65c){return _0x30a65c instanceof _0x219c92?_0x30a65c:new _0x219c92(function(_0x1bf7d5){_0x1bf7d5(_0x30a65c);});}return new(_0x219c92||(_0x219c92=Promise))(function(_0x322e6c,_0x4ff3e1){function _0x164d88(_0x534265){try{_0x54b3d4(_0x46c19b[a2_0x2e09('0x3')](_0x534265));}catch(_0x599665){_0x4ff3e1(_0x599665);}}function _0x33412b(_0x439985){try{_0x54b3d4(_0x46c19b['throw'](_0x439985));}catch(_0x86d6d5){_0x4ff3e1(_0x86d6d5);}}function _0x54b3d4(_0x19d200){_0x19d200[a2_0x2e09('0x1a')]?_0x322e6c(_0x19d200[a2_0x2e09('0x20')]):_0x27d896(_0x19d200[a2_0x2e09('0x20')])[a2_0x2e09('0x22')](_0x164d88,_0x33412b);}_0x54b3d4((_0x46c19b=_0x46c19b[a2_0x2e09('0x23')](_0x5cfeb2,_0x533616||[]))[a2_0x2e09('0x3')]());});};Object[a2_0x2e09('0x2')](exports,a2_0x2e09('0xd'),{'value':!![]});exports[a2_0x2e09('0x15')]=void 0x0;const environment_1=require(a2_0x2e09('0x24'));const {output}=require(a2_0x2e09('0x19'));class CloudRemoteCache{constructor(_0x193a08,_0x351f44,_0x2cfaa5,_0x3ca123){this[a2_0x2e09('0x16')]=_0x193a08;this['api']=_0x351f44;this['runContext']=_0x2cfaa5;this[a2_0x2e09('0x1e')]=_0x3ca123;this[a2_0x2e09('0x9')]=[];}[a2_0x2e09('0x2a')](_0x651aba,_0x28fa93){var _0x3e6fef;return __awaiter(this,void 0x0,void 0x0,function*(){if(this['messages'][a2_0x2e09('0x1f')])return![];const _0x1efdba=yield this['hashUrls'](_0x651aba);if(!_0x1efdba||!_0x1efdba[a2_0x2e09('0x17')]){if(environment_1[a2_0x2e09('0x27')]){output['note']({'title':a2_0x2e09('0x5')+_0x651aba+'.'});}this['runContext'][a2_0x2e09('0x14')][_0x651aba]='cache-miss';return![];}try{yield this['fileStorage'][a2_0x2e09('0x2a')](_0x651aba,_0x1efdba[a2_0x2e09('0x17')],_0x28fa93);this[a2_0x2e09('0x0')]['statuses'][_0x651aba]=a2_0x2e09('0x1');return!![];}catch(_0x3c9343){const _0x197f56=(_0x3e6fef=_0x3c9343[a2_0x2e09('0x2b')])!==null&&_0x3e6fef!==void 0x0?_0x3e6fef:_0x3c9343;if(_0x197f56[a2_0x2e09('0x1d')]&&_0x197f56[a2_0x2e09('0x1d')][a2_0x2e09('0x4')]===0x194){if(environment_1['VERBOSE_LOGGING']){output['note']({'title':a2_0x2e09('0x5')+_0x651aba+a2_0x2e09('0x29')});}}else{this[a2_0x2e09('0x16')][a2_0x2e09('0x1f')]=this[a2_0x2e09('0x16')]['extractErrorMessage'](_0x197f56,a2_0x2e09('0x2c'));}this['runContext'][a2_0x2e09('0x14')][_0x651aba]=a2_0x2e09('0x13');return![];}});}[a2_0x2e09('0x7')](_0x42890c,_0x395ad2){return __awaiter(this,void 0x0,void 0x0,function*(){if(this[a2_0x2e09('0x16')][a2_0x2e09('0x1f')])return![];const _0x15094d=Promise[a2_0x2e09('0x26')]()[a2_0x2e09('0x22')](()=>__awaiter(this,void 0x0,void 0x0,function*(){var _0x50d13c;const _0x14866f=yield this['hashUrls'](_0x42890c);if(!_0x14866f)return![];if(!_0x14866f['put']){if(environment_1['VERBOSE_LOGGING']){output[a2_0x2e09('0x6')]({'title':'Nx\x20Cloud:\x20Skipping\x20storing\x20'+_0x42890c+a2_0x2e09('0x1b')});}return!![];}try{yield this[a2_0x2e09('0x1e')][a2_0x2e09('0x7')](_0x42890c,_0x14866f[a2_0x2e09('0x12')],_0x395ad2);return!![];}catch(_0x24fed9){const _0x12df1a=(_0x50d13c=_0x24fed9['axiosException'])!==null&&_0x50d13c!==void 0x0?_0x50d13c:_0x24fed9;this[a2_0x2e09('0x16')]['cacheError']=this[a2_0x2e09('0x16')][a2_0x2e09('0x28')](_0x12df1a,a2_0x2e09('0x2c'));return![];}}));this[a2_0x2e09('0x9')]['push'](_0x15094d);return _0x15094d;});}['hashUrls'](_0x166e74){return __awaiter(this,void 0x0,void 0x0,function*(){if(_0x166e74 in this[a2_0x2e09('0x0')]['requests']){return(yield this[a2_0x2e09('0x0')][a2_0x2e09('0x11')][_0x166e74])[_0x166e74];}else{const _0x8b17ab=this[a2_0x2e09('0x0')]['scheduledTasks'][a2_0x2e09('0x8')](_0x32b4eb=>!this[a2_0x2e09('0x0')]['requests'][_0x32b4eb['hash']])[a2_0x2e09('0x1c')](_0x1cbc27=>_0x1cbc27[a2_0x2e09('0xf')]);if(_0x8b17ab['indexOf'](_0x166e74)===-0x1){_0x8b17ab[a2_0x2e09('0x21')](_0x166e74);}const _0x113f61=this[a2_0x2e09('0xe')][a2_0x2e09('0x25')](environment_1['NX_CLOUD_DISTRIBUTED_EXECUTION_ID'],_0x8b17ab);_0x8b17ab[a2_0x2e09('0xc')](_0x49d58f=>{this['runContext'][a2_0x2e09('0x11')][_0x49d58f]=_0x113f61;});return(yield _0x113f61)[_0x166e74];}});}[a2_0x2e09('0x10')](){return Promise[a2_0x2e09('0x18')](this[a2_0x2e09('0x9')])[a2_0x2e09('0x22')](_0xd4f45d=>_0xd4f45d[a2_0x2e09('0xa')]((_0x164e92,_0xaea8e8)=>_0x164e92&&_0xaea8e8,!![]));}}exports['CloudRemoteCache']=CloudRemoteCache;