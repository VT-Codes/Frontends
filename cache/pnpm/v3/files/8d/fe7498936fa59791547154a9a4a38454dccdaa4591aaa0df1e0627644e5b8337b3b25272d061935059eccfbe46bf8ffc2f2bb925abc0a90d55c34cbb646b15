const a6_0x5121=['configuration','__esModule','parseCommand','target','data','createMetricRecorder','recordMetric','DistributedExecutionApi','parallel','post','message','/nx-cloud/executions/status','start','overrides','axiosException','enabled','map','../../../utilities/environment','/nx-cloud/executions/complete-run-group','dteStatus','RUNNER_FAILURE_PERF_ENTRY','getBranch','then','exit','completeRunGroup','value','join','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','done','mapRespToPerfEntry','dteStart','agentCount','apiAxiosInstance','axiosMultipleTries','createStartRequest','response','next','createApiAxiosInstance','error','Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.','false','/nx-cloud/executions/start','defineProperty','project','completeRunGroupWithError','status','maxParallel','NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE','throw'];(function(_0x36badb,_0x51218e){const _0x264e5c=function(_0x48bed0){while(--_0x48bed0){_0x36badb['push'](_0x36badb['shift']());}};_0x264e5c(++_0x51218e);}(a6_0x5121,0x14a));const a6_0x264e=function(_0x36badb,_0x51218e){_0x36badb=_0x36badb-0x0;let _0x264e5c=a6_0x5121[_0x36badb];return _0x264e5c;};'use strict';var __awaiter=this&&this['__awaiter']||function(_0x27e7df,_0x29c13b,_0x41100a,_0x2d75a7){function _0xd8dc4f(_0x108d2d){return _0x108d2d instanceof _0x41100a?_0x108d2d:new _0x41100a(function(_0x3baef5){_0x3baef5(_0x108d2d);});}return new(_0x41100a||(_0x41100a=Promise))(function(_0x7a0b28,_0x4d6e67){function _0x236aea(_0x1e1402){try{_0x3fcec7(_0x2d75a7[a6_0x264e('0x0')](_0x1e1402));}catch(_0x3d9d4d){_0x4d6e67(_0x3d9d4d);}}function _0x44272d(_0x16a86b){try{_0x3fcec7(_0x2d75a7[a6_0x264e('0xc')](_0x16a86b));}catch(_0x22ffd4){_0x4d6e67(_0x22ffd4);}}function _0x3fcec7(_0x4786e6){_0x4786e6[a6_0x264e('0x29')]?_0x7a0b28(_0x4786e6[a6_0x264e('0x26')]):_0xd8dc4f(_0x4786e6[a6_0x264e('0x26')])[a6_0x264e('0x23')](_0x236aea,_0x44272d);}_0x3fcec7((_0x2d75a7=_0x2d75a7['apply'](_0x27e7df,_0x29c13b||[]))['next']());});};Object[a6_0x264e('0x6')](exports,a6_0x264e('0xe'),{'value':!![]});exports[a6_0x264e('0x2f')]=exports[a6_0x264e('0x14')]=void 0x0;const axios_1=require('../../../utilities/axios');const environment_1=require(a6_0x264e('0x1e'));const metric_logger_1=require('../../../utilities/metric-logger');const {output,unparse}=require('../../../utilities/nx-imports');class DistributedExecutionApi{constructor(_0x2853e5){this[a6_0x264e('0x2d')]=(0x0,axios_1[a6_0x264e('0x1')])(_0x2853e5);}[a6_0x264e('0x19')](_0xfa5beb){var _0x19f4da;return __awaiter(this,void 0x0,void 0x0,function*(){const _0xb7d893=(0x0,metric_logger_1['createMetricRecorder'])(a6_0x264e('0x2b'));let _0x17f615;try{_0x17f615=yield(0x0,axios_1[a6_0x264e('0x2e')])(()=>this[a6_0x264e('0x2d')]['post'](a6_0x264e('0x5'),_0xfa5beb));_0xb7d893['recordMetric']((0x0,metric_logger_1[a6_0x264e('0x2a')])(_0x17f615));}catch(_0x167eee){_0xb7d893['recordMetric'](((_0x19f4da=_0x167eee===null||_0x167eee===void 0x0?void 0x0:_0x167eee[a6_0x264e('0x1b')])===null||_0x19f4da===void 0x0?void 0x0:_0x19f4da[a6_0x264e('0x30')])?(0x0,metric_logger_1[a6_0x264e('0x2a')])(_0x167eee[a6_0x264e('0x1b')][a6_0x264e('0x30')]):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);throw _0x167eee;}if(!_0x17f615['data'][a6_0x264e('0x1c')]){throw new Error(a6_0x264e('0x3'));}if(_0x17f615['data'][a6_0x264e('0x2')]){throw new Error(_0x17f615[a6_0x264e('0x11')]['error']);}return _0x17f615['data']['id'];});}[a6_0x264e('0x9')](_0x1e88a5){var _0x146d74;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x14910b=(0x0,metric_logger_1[a6_0x264e('0x12')])(a6_0x264e('0x20'));try{const _0x4742b5=yield(0x0,axios_1['axiosMultipleTries'])(()=>this[a6_0x264e('0x2d')][a6_0x264e('0x16')](a6_0x264e('0x18'),{'id':_0x1e88a5}));_0x14910b[a6_0x264e('0x13')]((0x0,metric_logger_1[a6_0x264e('0x2a')])(_0x4742b5));return _0x4742b5[a6_0x264e('0x11')];}catch(_0x3e9cbd){_0x14910b[a6_0x264e('0x13')](((_0x146d74=_0x3e9cbd===null||_0x3e9cbd===void 0x0?void 0x0:_0x3e9cbd[a6_0x264e('0x1b')])===null||_0x146d74===void 0x0?void 0x0:_0x146d74['response'])?(0x0,metric_logger_1[a6_0x264e('0x2a')])(_0x3e9cbd[a6_0x264e('0x1b')][a6_0x264e('0x30')]):metric_logger_1[a6_0x264e('0x21')]);output['error']({'title':_0x3e9cbd[a6_0x264e('0x17')]});process[a6_0x264e('0x24')](0x1);}});}[a6_0x264e('0x8')](_0x59416d,_0x31bbc7){var _0x1d2211;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x1d2dc6=(0x0,metric_logger_1['createMetricRecorder'])(a6_0x264e('0x25'));try{const _0x4ae464=yield(0x0,axios_1[a6_0x264e('0x2e')])(()=>this[a6_0x264e('0x2d')][a6_0x264e('0x16')](a6_0x264e('0x1f'),{'runGroup':_0x59416d,'criticalErrorMessage':_0x31bbc7}),0x3);_0x1d2dc6[a6_0x264e('0x13')]((0x0,metric_logger_1['mapRespToPerfEntry'])(_0x4ae464));}catch(_0x4880ae){_0x1d2dc6[a6_0x264e('0x13')](((_0x1d2211=_0x4880ae===null||_0x4880ae===void 0x0?void 0x0:_0x4880ae[a6_0x264e('0x1b')])===null||_0x1d2211===void 0x0?void 0x0:_0x1d2211[a6_0x264e('0x30')])?(0x0,metric_logger_1[a6_0x264e('0x2a')])(_0x4880ae[a6_0x264e('0x1b')][a6_0x264e('0x30')]):metric_logger_1[a6_0x264e('0x21')]);}});}}exports[a6_0x264e('0x14')]=DistributedExecutionApi;function createStartRequest(_0xa8d649,_0x2ebaa4,_0x116728){const _0x43266d=_0x2ebaa4[a6_0x264e('0x1d')](_0x3dad07=>{return _0x3dad07[a6_0x264e('0x1d')](_0x454318=>{return{'taskId':_0x454318['id'],'hash':_0x454318['hash'],'projectName':_0x454318[a6_0x264e('0x10')][a6_0x264e('0x7')],'target':_0x454318['target'][a6_0x264e('0x10')],'configuration':_0x454318[a6_0x264e('0x10')][a6_0x264e('0xd')]||null,'params':unparse(_0x454318[a6_0x264e('0x1a')])[a6_0x264e('0x27')]('\x20')};});});const _0x3b551b={'command':(0x0,environment_1[a6_0x264e('0xf')])(),'branch':(0x0,environment_1[a6_0x264e('0x22')])(),'runGroup':_0xa8d649,'tasks':_0x43266d,'maxParallel':calculateMaxParallel(_0x116728)};if(environment_1['NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT']){_0x3b551b[a6_0x264e('0x2c')]=environment_1[a6_0x264e('0x28')];}if(!environment_1[a6_0x264e('0xb')]){_0x3b551b['stopAgentsOnFailure']=![];}return _0x3b551b;}exports[a6_0x264e('0x2f')]=createStartRequest;function calculateMaxParallel(_0x534bfd){if(_0x534bfd['parallel']===a6_0x264e('0x4')||_0x534bfd[a6_0x264e('0x15')]===![]){return 0x1;}else if(_0x534bfd[a6_0x264e('0x15')]==='true'||_0x534bfd[a6_0x264e('0x15')]===!![]){return Number(_0x534bfd[a6_0x264e('0xa')]||0x3);}else if(_0x534bfd['parallel']===undefined){return _0x534bfd[a6_0x264e('0xa')]?Number(_0x534bfd['maxParallel']):0x3;}else{return Number(_0x534bfd[a6_0x264e('0x15')])||0x3;}}